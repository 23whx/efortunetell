# 富文本编辑器使用指南

## 概览

本项目已经成功实现了一个现代化的富文本编辑器系统，参考了知乎专栏和B站文章编辑页面的设计理念，具备以下核心功能：

## 主要功能特性

### 1. 现代化富文本编辑器 (Tiptap)
- **技术栈**: 基于 Tiptap + React，兼容 React 19
- **工具栏功能**:
  - 撤销/重做
  - 标题格式 (H1, H2, H3)
  - 文字格式 (加粗、斜体、删除线、代码)
  - 文本对齐 (左对齐、居中、右对齐)
  - 列表 (有序、无序)
  - 引用和分割线
  - 颜色选择器 (15种预设颜色)
  - 图片插入

### 2. 图片处理功能
- **拖拽上传**: 直接拖拽图片到编辑器中
- **粘贴上传**: 支持 Ctrl+V 粘贴图片
- **点击上传**: 工具栏图片按钮选择文件
- **自动提取**: 从文章内容中自动提取图片列表

### 3. 封面图片选择器
- **智能选择**: 从文章图片中选择封面
- **独立上传**: 单独上传封面图片
- **预览功能**: 实时预览选中的封面
- **移除功能**: 一键移除当前封面

### 4. 编辑/预览模式
- **双模式切换**: 编辑模式 ↔ 预览模式
- **实时预览**: 即时查看文章最终效果
- **样式完整**: 包含封面、标题、摘要、内容

### 5. 文章管理
- **草稿保存**: 支持保存为草稿
- **发布功能**: 一键发布文章
- **编辑模式**: 支持编辑已有文章
- **分类标签**: 完整的分类和标签系统

## 文件结构

```
E-Front-end/src/
├── components/ui/
│   ├── RichTextEditor.tsx      # 富文本编辑器组件
│   └── CoverImageSelector.tsx  # 封面图片选择器
├── app/admin/edit/
│   └── page.tsx                # 文章编辑页面
└── app/globals.css             # 编辑器样式
```

## 使用方法

### 访问编辑器
1. 登录管理员账户
2. 访问 `/admin/edit` 创建新文章
3. 访问 `/admin/edit?id=文章ID` 编辑现有文章

### 编写文章
1. **输入标题**: 顶部大标题输入框
2. **设置元信息**: 分类、标签、摘要
3. **编写内容**: 使用富文本编辑器
4. **插入图片**: 
   - 拖拽图片到编辑器
   - 复制粘贴图片
   - 点击工具栏图片按钮
5. **选择封面**: 从文章图片中选择或单独上传
6. **预览效果**: 切换到预览模式查看
7. **保存发布**: 选择保存草稿或发布文章

### 图片功能
- **支持格式**: JPG, PNG, GIF, WebP
- **自动压缩**: 后端自动处理图片大小
- **URL管理**: 自动生成可访问的图片链接
- **批量处理**: 支持同时处理多张图片

## 技术特点

### 响应式设计
- 移动端友好
- 自适应布局
- 触控操作支持

### 性能优化
- 懒加载编辑器
- 图片压缩处理
- 异步上传机制

### 用户体验
- 实时保存提示
- 加载状态显示
- 错误处理机制
- 操作撤销支持

## API 集成

### 后端接口
- `POST /api/upload/image` - 图片上传
- `POST /api/articles` - 创建文章
- `PUT /api/articles/:id` - 更新文章
- `GET /api/articles/:id` - 获取文章详情

### 图片存储
- 统一存储在 `E-Backend-Project/public/images/`
- 自动生成唯一文件名
- 支持代理访问

## 样式系统

### Tiptap 样式
- 自定义 ProseMirror 样式
- 拖拽指示器
- 选中状态样式

### Tailwind Typography
- prose 类支持
- 响应式文字大小
- 语义化HTML渲染

## 浏览器兼容性
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 下一步增强

可以考虑添加的功能：
1. 代码块语法高亮
2. 表格插入编辑
3. 数学公式支持
4. 视频嵌入功能
5. 文章协作编辑
6. 版本历史管理
7. 自动保存草稿
8. 快捷键支持

## 故障排除

### 常见问题
1. **图片不显示**: 检查后端图片服务是否正常
2. **编辑器不加载**: 确保 Tiptap 依赖已正确安装
3. **样式异常**: 检查 Tailwind CSS 配置
4. **上传失败**: 查看后端上传接口和文件权限

### 调试建议
1. 打开浏览器开发者工具
2. 查看 Console 中的错误信息
3. 检查 Network 标签页的请求状态
4. 确认后端服务正常运行

---

这个富文本编辑器系统提供了完整的文章创作体验，支持现代化的编辑功能和图片管理，非常适合博客、CMS 等内容管理场景。 